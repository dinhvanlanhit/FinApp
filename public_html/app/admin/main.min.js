
const Toast = Swal.mixin({
    toast: true,
    position: 'top-end',
    showConfirmButton: false,
    timer: 3000
});
function null_to_number(e){
    if(e==null||e=='null'){
        return 0;
    }else{
        return e;
    }
}
function init_tinymce(selector, min_height) {
    var menu_bar = 'file edit view insert format tools table help';
    if (selector == '.tinyMCEQuiz') {
        menu_bar = false;
    }
    var data =  tinymce.init({
        // inline: true,
        selector: selector,
        min_height: min_height,
        valid_elements: '*[*]',
        relative_urls: false,
        remove_script_host: false,
        language: 'vi',
        menubar: menu_bar,
        plugins: [
            "advlist autolink lists link image charmap print preview anchor",
            "searchreplace visualblocks code codesample fullscreen",
            "insertdatetime media table paste imagetools"
        ],
        toolbar: 'fullscreen code preview | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | numlist bullist | forecolor backcolor removeformat | image media link | outdent indent',
        content_css: [editor_content_css],
        codesample_languages: [
            { text: 'HTML/XML', value: 'markup' },
            { text: 'JavaScript', value: 'javascript' },
            { text: 'CSS', value: 'css' },
            { text: 'PHP', value: 'php' },
            { text: 'Ruby', value: 'ruby' },
            { text: 'Python', value: 'python' },
            { text: 'Java', value: 'java' },
            { text: 'C', value: 'c' },
            { text: 'C#', value: 'csharp' },
            { text: 'C++', value: 'cpp' }
          ],
    });
    tinymce.DOM.loadCSS(editor_ui_css);
    return data;
}
function readImage(inputElement) {
    var deferred = $.Deferred();
    var files = inputElement.get(0).files;
    if (files && files[0]) {
        var fr = new FileReader();
        fr.onload = function (e) {
            deferred.resolve(e.target.result);
        };
        fr.readAsDataURL(files[0]);
    } else {
        deferred.resolve(undefined);
    }
    return deferred.promise();
}
function setImgSRC(InputFile, img) {
    readImage($(InputFile)).done(function (base64Data) {
        $(img).attr('src', base64Data);
    });
}
$(document).ready(function(){
    $.ajaxSetup({headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content') }});
    $('.select2bs4').select2({
        theme: 'bootstrap4'
    });
    var pathname = window.location.href;
    var elmParent =  $('.nav > li > a[href="'+pathname+'"]');
    elmParent.addClass('active');
    var elmParent =  $('.nav-treeview > li > a[href="'+pathname+'"]');
    elmParent.addClass('active')

    elmParent.parents('.has-treeview').children().addClass('active')
    elmParent.parents('.has-treeview').addClass('active menu-open')
    elmParent.parent().parent().attr('style','display: block;').parent().addClass('active');
    elmParent.addClass('active ');
  
    

});
function buttonloading(e, type) {
    if (e != undefined && type != undefined) {
        if (type == true) {
            if (!$(e).children("i").hasClass("loadding")) {
                $(e).attr('disabled',type);
                $(e).prepend('<i  class="loadding spinner-border spinner-border-sm mr-1"></i>');
            }
        } else {
            if ($(e).children("i").hasClass("loadding")) {
                $(e).children("i").remove();
                $(e).attr('disabled',type);
            }
        }
    }
}

    var Lang = 'vi';
    var dateRangePickerLocale = Lang == "en"?{
            format: "DD-MM-YYYY",
            customRangeLabel: "Custom",
            applyLabel: "Select",
            cancelLabel: "Delete",
    }:{
            format: "DD-MM-YYYY",
            customRangeLabel: "Tùy Chọn",
            applyLabel: "Chọn",
            cancelLabel: "Xóa",
    };
function daterange(daterange,dateBegin,dateEnd){
    var begin = moment(moment().startOf("month")).format("YYYY-MM-DD");
    var end = moment(moment().endOf("month")).format("YYYY-MM-DD");
    $(dateBegin).val(begin);
    $(dateEnd).val(end);
    $(daterange).daterangepicker({
        ranges   : {
            'Từ trước đến nay'  : ['', ''],
            'Tháng này'  : [moment().startOf('month'), moment().endOf('month')],
            'Tháng trước'  : [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
            'Hôm nay'       : [moment(), moment()],
            'Hôm qua'   : [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
            '7 Ngày qua' : [moment().subtract(6, 'days'), moment()],
            '30 ngày trước': [moment().subtract(29, 'days'), moment()],
            'Năm nay'  : [moment().startOf('year'), moment().endOf('year')],
            'Năm trước'  : [moment().subtract(1, 'year').startOf('year'),moment().subtract(1, 'year').endOf('year')],
        },
        locale: dateRangePickerLocale,
        startDate: moment(moment().startOf("month"), "DD-MM-YYYY"),
        endDate: moment(moment().endOf("month"), "DD-MM-YYYY"),
        language:Lang,
    },
    function (start, end,label) {
        $(".daterangepicker_label").val(label);
        if(start._isValid==false||end._isValid==false){
            $(daterange).attr('readonly',true);
            $(dateBegin).val("");
            $(dateEnd).val("");
        }else{
            $(dateBegin).val(start.format("YYYY-MM-DD"));
            $(dateEnd).val(end.format("YYYY-MM-DD"));
            $(daterange).attr('readonly',false);
        }
    }
   );
}
daterange('#daterange','#dateBegin','#dateEnd');
    


function input_money_format(e) {
    $(e).val($(e).val().replace(/\D/gm, ""));
    var val = $(e).val().split(",").join("");
    e.value = val.toString().split(/(?=(?:\d{3})+(?:\.|$))/g).join(",");
}
function money_format_to_number(e) {
    return parseFloat(e.toString().replace(/,/g, ""));
}
function money_format(e) {
    
    if(e==null&&e==''){
        return '';
    }else{
        return e.toString().split(/(?=(?:\d{3})+(?:\.|$))/g).join(",");
    }
  
}
function _AjaxDelete(dataOject,url){
    var isBoool = false;
    $.ajax({
        url:url,
        type:'POST',
        data:dataOject,
        dataType:'JSON',
        async:false,
        success:function(data){
            if(data.statusBoolen){
                isBoool= true;
            }else{
                isBoool= false;
            }
        },error:function (error) {
            console.log(error);
            isBoool= false;
        }
    });
    return isBoool;
}

function rederAction(data){
    var htmlButton='<div class="text-center"><div class="">';
            htmlButton+='<button type="button" class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown"> Tác vụ</button>';
            htmlButton+='<div class="dropdown-menu">';
                $.each(data,function(index,item){
                    htmlButton+='<button class="dropdown-item  '+item.class+'" '+item.attr+' value="'+item.value+'" title="'+item.title+'">'+item.icon+'&nbsp;'+item.text+'</button>';
                });    
             htmlButton+='</div>';
        htmlButton+='</div>';
        htmlButton+='</div>';
    return htmlButton;
}
function surplus(){
    $.ajax({
        url:wallet_total,
        type:'GET',
        dataType:'JSON',
        async:false,
        success:function(data){
            $(".surplus").text(money_format(data.data));
        },error:function (error) {
            console.log(error);
        }
    });
}  
