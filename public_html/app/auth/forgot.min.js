function buttonloading(e, type) {
    if (e != undefined && type != undefined) {
        if (type == true) {
            if (!$(e).children("i").hasClass("loadding")) {
                $(e).attr('disabled',type);
                $(e).prepend('<i  class="loadding spinner-border spinner-border-sm mr-1"></i>');
            }
        } else {
            if ($(e).children("i").hasClass("loadding")) {
                $(e).children("i").remove();
                $(e).attr('disabled',type);
            }
        }
    }
}
function alertJS(message){
    var alerthtml = '<div class="alert alert-danger text-small alert-dismissible" role="alert">';
    alerthtml +=''+message+'';
    alerthtml +='<button type="button" class="close" data-dismiss="alert" aria-label="Close">';
    alerthtml +='<span aria-hidden="true">&times;</span>';
    alerthtml +='</button>';
    alerthtml +='</div>'
    return alerthtml;
 }
$(document).ready(function(){
    $.ajaxSetup({headers: { 'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content') }});
    $("#formSendEmail").on('submit',function(e){
        e.preventDefault();
        buttonloading('#button-formSendEmail',true);
        e.preventDefault();
        var formData = new FormData(this);
        $.ajax({
            url:routes.sendEmail,
            type:'POST',
            data:formData,
            dataType:'JSON',
            processData: false,
            contentType: false,
            success:function(data){
                console.log(data);
                if(data.statusBoolen){
                    return window.location.href=routes.recover_code;
                }else{
                    $(".email").html(alertJS(data.messages));
                    buttonloading('#button-formSendEmail',false);
                }
            },error:function(error){
                $(".email").html(alertJS('<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Emergency notification','The server system is having a problem waiting for a moment!'));
                buttonloading('#button-formSendEmail',false);
            }
        });
       
    });
    $("#btn-formSendEmail").on('click',function(e){
        buttonloading('#btn-formSendEmail',true);
        $.ajax({
            url:routes.sendEmail,
            type:'POST',
            data:{
                email:$("#email").val()
            },
            dataType:'JSON',
            success:function(data){
                if(data.statusBoolen){
                    buttonloading('#btn-formSendEmail',false);
                }
            },error:function(error){
                $(".email").html(alertJS('<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Emergency notification','The server system is having a problem waiting for a moment!'));
                buttonloading('#btn-formSendEmail',false);
            }
        });
    });
    $("#formRecoverCode").on('submit',function(e){
        e.preventDefault();
        buttonloading('#button-recover_code',true);
        e.preventDefault();
        var formData = new FormData(this);
        $.ajax({
            url:routes.recover_code,
            type:'POST',
            data:formData,
            dataType:'JSON',
            processData: false,
            contentType: false,
            success:function(data){
                if(data.statusBoolen){
                    return window.location.href=routes.password;
                }else{
                    $(".recover_code").html(alertJS(data.messages));
                    buttonloading('#button-recover_code',false);
                }
            },error:function(error){
                $(".recover_code").html(alertJS('<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Emergency notification','The server system is having a problem waiting for a moment!'));
                buttonloading('#button-recover_code',false);
            }
        });
    });
    $("#formChangePassword").on('submit',function(e){
        e.preventDefault();
        buttonloading('#button-password',true);
        e.preventDefault();
        var formData = new FormData(this);
        $.ajax({
            url:routes.passowrd,
            type:'POST',
            data:formData,
            dataType:'JSON',
            processData: false,
            contentType: false,
            success:function(data){
                if(data.statusBoolen){
                    return window.location.href=routes.login;
                }else{
                    $(".password").html(alertJS(data.messages));
                    buttonloading('#button-password',false);
                }
            },error:function(error){
                $(".password").html(alertJS('<i class="fa fa-exclamation-triangle" aria-hidden="true"></i> Emergency notification','The server system is having a problem waiting for a moment!'));
                buttonloading('#button-password',false);
            }
        });
    });
})